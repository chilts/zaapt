%# ----------------------------------------------------------------------------
<%args>
    $action => undef
    $elements
</%args>
%# ----------------------------------------------------------------------------
<form action="<% $action || '?' %>" method="post">
% foreach my $e ( @$elements ) {
%     if ( $e->{type} eq 'hidden' ) {
<input type="hidden" name="<% $e->{name} | h %>" value="<% $e->{value} | h %>" />
%     }
% }
<table>
% foreach my $e ( @$elements ) {
%     next if $e->{type} eq 'hidden';
    <tr>
        <td class="key"><% $e->{field} | h %><% length($e->{field}) ? ' :' : '&nbsp;' %></td>
        <td class="val">
%     if ( $e->{type} eq 'text' ) {
            <input type="text" name="<% $e->{name} | h %>" value="<% $e->{value} | h %>"<% $e->{size} ? " size=\"$e->{size}\"" : ''%><% $e->{maxlength} && " maxlength=\"$e->{maxlength}\"" %> />\

%     } elsif ( $e->{type} eq 'password' ) {
            <input type="password" name="<% $e->{name} | h %>" value=""<% $e->{size} ? " size=\"$e->{size}\"" : ''%><% $e->{maxlength} && " maxlength=\"$e->{maxlength}\"" %> />\

%     } elsif ( $e->{type} eq 'textarea' ) {
            <textarea name="<% $e->{name} | h %>"<% $e->{rows} && " rows=\"$e->{rows}\"" %><% $e->{cols} && " cols=\"$e->{cols}\"" %>><% $e->{value} | h %></textarea>\

%     } elsif ( $e->{type} eq 'select' ) {
            <select name="<% $e->{name} | h %>">
%         foreach my $o ( @{$e->{options}} ) {
                <option value="<% $o->{value} | h %>"<% $e->{selected} eq $o->{value} ? ' selected="selected"' : '' %>><% $o->{text} | h %></option>
%         }
            </select>

%     } elsif ( $e->{type} eq 'radio' ) {
%         foreach my $o ( @{$e->{options}} ) {
                <input type="radio" name="<% $e->{name} | h %>" value="<% $o->{value} | h %>"<% $e->{checked} eq $o->{value} ? ' checked="checked"' : '' %> /><% $o->{name} | h %>
%         }

%     } elsif ( $e->{type} eq 'info' ) {
            <% $e->{value} | h %>\

%     } elsif ( $e->{type} eq 'note' ) {
            <% $e->{value} | h %>\

%     } elsif ( $e->{type} eq 'html' ) {
            <% $e->{value} %>\

%     } elsif ( $e->{type} eq 'hidden' ) {
%# do nothing

%     } elsif ( $e->{type} eq 'read' ) {
            <% $e->{value} | h %>\

%     } elsif ( $e->{type} eq 'check' ) {
            <input type="checkbox" name="<% $e->{name} | h %>"<% $e->{checked} && ' checked="checked"' %> />\

%     } elsif ( $e->{type} eq 'submit' ) {
            <button class="button" type="submit"><% $e->{value} | h %></button>\
%         if ( defined $e->{cancel} ) {
            <button class="button" type="button" onclick="document.location='<% $e->{cancel} %>';">Cancel</button>\
%         }
%         if ( defined $e->{cancel_href} ) {
            <button class="button" type="button" onclick="document.location='<% $e->{cancel_href} %>';">Cancel</button>\
%         }
%         if ( defined $e->{cancel_js} ) {
            <button class="button" type="button" onclick="<% $e->{cancel_js} %>">Cancel</button>\
%         }

%     } elsif ( $e->{type} eq 'button' ) {
            <button type="button" onClick="<% $e->{onclick} | h %>"><% $e->{value} | h %></button>\

%     } else {
            Unknown type: <% $e->{type} | h %>\
%     }
        </td>
    </tr>
% }
</table>
</form>
%# ----------------------------------------------------------------------------
