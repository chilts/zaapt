%# ----------------------------------------------------------------------------
<%args>
    $zaapt
    $my_roles
    $a_id => undef
    $r_id => undef
    $from => 'list'
</%args>
%# ----------------------------------------------------------------------------
<%once>
    my $allowed = {
        from => {
            list    => 'edit-p-list.html',
            account => 'edit-p-list-by-account.html',
            role    => 'edit-p-list-by-role.html',
        },
    };
</%once>
%# ----------------------------------------------------------------------------
<%init>
    $m->redirect('edit-r-list.html') unless exists $my_roles->{super};

    $from = 'list' unless exists $allowed->{from}{$from};
    my $redirect_to = $allowed->{from}{$from};

    my $model = $zaapt->get_model('Account');
    my $account = $model->sel_account({ a_id => $a_id });
    my $role = $model->sel_role({ r_id => $r_id });

    $m->redirect($redirect_to) unless defined $account;
    $m->redirect($redirect_to) unless defined $role;

    $model->ins_privilege({
        a_id  => $a_id,
        r_id => $r_id,
    });
    $m->redirect($redirect_to);
    return;
</%init>
%# ----------------------------------------------------------------------------
