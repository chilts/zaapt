%# ----------------------------------------------------------------------------
<%args>
    $zaapt
    $g_name
    $p_name
</%args>
%# ----------------------------------------------------------------------------
<%init>
    my $model = $zaapt->get_model('Gallery');
    my $gallery = $model->sel_gallery_using_name({ g_name => $g_name });
    unless ( defined $gallery ) {
        die "gallery '$g_name' not found";
        return;
    }

    my $picture = $model->sel_picture_using_name({ p_name => $p_name });
    unless ( defined $picture ) {
        $m->clear_buffer();
        $m->abort(404);
        return;
    }

    my $details = $model->sel_picture_detail_all({ p_id => $picture->{p_id} });
</%init>
%# ----------------------------------------------------------------------------
<& render-picture.mhtml, gallery => $gallery, picture => $picture, details => $details &>
%# ----------------------------------------------------------------------------
